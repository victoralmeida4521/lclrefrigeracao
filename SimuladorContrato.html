<html><head><base href="/" /><meta charset="UTF-8">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .main-button {
        padding: 20px 40px;
        font-size: 1.5rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }

    .main-button:hover {
        background-color: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
    }

    .main-button:active {
        transform: translateY(0);
    }

    .modal-content {
        border-radius: 15px;
        box-shadow: 0 0 25px rgba(0,0,0,0.15);
    }

    .modal-header {
        background-color: #3498db;
        color: white;
        border-radius: 15px 15px 0 0;
    }

    .machine-input {
        margin: 10px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .machine-input:hover {
        background: #e9ecef;
    }

    .btn-calculate {
        background-color: #3498db;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        max-width: 200px;
    }

    .btn-calculate:hover {
        background-color: #2980b9;
        transform: translateY(-2px);
    }

    .result {
        margin-top: 20px;
        padding: 20px;
        background-color: #e8f6ff;
        border-radius: 8px;
        text-align: center;
        font-size: 1.2em;
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .result.show {
        opacity: 1;
    }

    .price {
        color: #27ae60;
        font-weight: bold;
        font-size: 1.4em;
    }

    .error {
        color: #e74c3c;
        margin-top: 10px;
        padding: 10px;
        border-radius: 4px;
        background-color: #fde8e8;
        animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
    }
</style>
</head>
<body>
    <button class="main-button" data-bs-toggle="modal" data-bs-target="#simulatorModal">
        Simule seu contrato aqui
    </button>

    <!-- Modal -->
    <div class="modal fade" id="simulatorModal" tabindex="-1" aria-labelledby="simulatorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="simulatorModalLabel">Simulador de Contrato de Manutenção</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="input-section">
                        <button onclick="generateInputs()" class="btn-calculate mb-3">Adicionar Máquina</button>
                        
                        <div id="machinesContainer" class="machines-container"></div>
                        
                        <button onclick="calculateBudget()" class="btn-calculate mt-4">Calcular Orçamento</button>
                    </div>

                    <div class="output-section">
                        <div id="result" class="result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
function generateInputs() {
    const container = document.getElementById('machinesContainer');
    const currentMachines = container.children.length;
    
    const machineDiv = document.createElement('div');
    machineDiv.className = 'machine-input';
    machineDiv.innerHTML = `
        <div class="form-group">
            <label>Máquina ${currentMachines + 1} - Capacidade (BTUs):</label>
            <input type="number" class="btu-input form-control" 
                   min="1000" step="1000" placeholder="Ex: 12000"
                   oninput="validateInput(this)">
            <small class="text-muted">Insira um valor maior que zero</small>
        </div>
    `;
    container.appendChild(machineDiv);
}

function validateInput(input) {
    if (input.value < 0) {
        input.value = '';
        input.classList.add('is-invalid');
        setTimeout(() => input.classList.remove('is-invalid'), 500);
    }
}

function calculateBudget() {
    const inputs = document.querySelectorAll('.btu-input');
    const result = document.getElementById('result');
    result.className = 'result';
    
    let totalBTUs = 0;
    let isValid = true;
    let errorMessage = '';

    inputs.forEach((input, index) => {
        const btus = parseInt(input.value);
        if (isNaN(btus) || btus <= 0) {
            isValid = false;
            errorMessage = `Por favor, insira um valor válido para a Máquina ${index + 1}`;
            input.classList.add('is-invalid');
            setTimeout(() => input.classList.remove('is-invalid'), 500);
            return;
        }
        totalBTUs += btus;
    });

    if (!isValid) {
        result.innerHTML = `<div class="error">${errorMessage}</div>`;
        result.classList.add('show');
        return;
    }

    const pricePerUnit = 100;
    const monthlyBudget = Math.ceil(totalBTUs / 12000) * pricePerUnit;

    result.innerHTML = `
        <div>
            <p>Capacidade Total: <strong>${totalBTUs.toLocaleString()} BTUs</strong></p>
            <p>Orçamento Mensal: <span class="price">R$ ${monthlyBudget.toLocaleString()},00</span></p>
        </div>
    `;
    
    result.classList.add('show');
}

// Initialize with one input field when modal opens
document.getElementById('simulatorModal').addEventListener('shown.bs.modal', function () {
    const container = document.getElementById('machinesContainer');
    if (container.children.length === 0) {
        generateInputs();
    }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body></html>